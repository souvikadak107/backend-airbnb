<%- include('../partials/head') %>
</head>
<body class="bg-gray-100">

<%- include('../partials/nav') %>

<main class="container mx-auto max-w-2xl mt-10 bg-white shadow-lg rounded-lg p-8">
  <h2 class="text-3xl font-bold text-center text-red-500 mb-8">
    Guest & Stay Details
  </h2>

  <form action="/homes/booking/<%= home._id %>" method="POST" class="space-y-8">

    <!-- Guests -->
    <section>
      <h3 class="text-xl font-semibold mb-4">Guests</h3>

      <div id="guestContainer" class="space-y-3">
        <div class="flex gap-3 items-center guest-row">
          <input
            type="text"
            name="guestName[]"
            required
            placeholder="Guest Name"
            class="w-full border rounded-md p-2"
          />
          <input
            type="number"
            name="guestAge[]"
            required
            min="0"
            placeholder="Age"
            class="w-24 border rounded-md p-2"
          />
          <button
            type="button"
            class="removeBtn text-red-500 font-bold px-2 hidden"
            onclick="removeGuest(this)"
          >
            ✕
          </button>
        </div>
      </div>

      <button
        type="button"
        onclick="addGuest()"
        class="mt-3 text-sm bg-gray-200 px-4 py-2 rounded hover:bg-gray-300"
      >
        + Add another guest
      </button>
    </section>

    <!-- Dates -->
    <section>
      <h3 class="text-xl font-semibold mb-4">Stay Duration</h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <input type="date" name="checkIn" required class="border rounded-md p-2" />
        <input type="date" name="checkOut" required class="border rounded-md p-2" />
      </div>
    </section>

    <!-- Phone -->
    <section>
      <h3 class="text-xl font-semibold mb-4">Contact Information</h3>
      <input
        type="tel"
        name="phone"
        required
        pattern="[0-9]{10}"
        placeholder="10-digit phone number"
        class="w-full border rounded-md p-2"
      />
    </section>

    <input type="submit" value="Pay Now" class="w-full bg-red-500 text-white py-2 rounded-md hover:bg-red-600 transition duration-300" />


  </form>
</main>

<script>
  function updateRemoveButtons() {
    const rows = document.querySelectorAll(".guest-row");
    rows.forEach(row => {
      const btn = row.querySelector(".removeBtn");
      btn.classList.toggle("hidden", rows.length === 1);
    });
  }

  function addGuest() {
    const container = document.getElementById("guestContainer");

    const row = document.createElement("div");
    row.className = "flex gap-3 items-center guest-row";
    row.innerHTML = `
      <input type="text" name="guestName[]" required placeholder="Guest Name"
        class="w-full border rounded-md p-2" />
      <input type="number" name="guestAge[]" required min="0" placeholder="Age"
        class="w-24 border rounded-md p-2" />
      <button type="button"
        class="removeBtn text-red-500 font-bold px-2"
        onclick="removeGuest(this)">✕</button>
    `;
    container.appendChild(row);
    updateRemoveButtons();
  }

  function removeGuest(btn) {
    btn.closest(".guest-row").remove();
    updateRemoveButtons();
  }

  // initialize
  updateRemoveButtons();
</script>

</body>
</html>
